{% extends 'base.html' %}

{% block title %}Sua Senha - Lumina Beauty{% endblock %}

{% block content %}
<style>
    .reveal-card {
        background: #ffffff;
        border-radius: 20px;
        border: 1px solid #f0e6e8;
        box-shadow: 0 10px 30px rgba(107, 73, 80, 0.08);
        overflow: hidden;
    }

    .icon-header {
        background-color: #fff0f3;
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto;
        color: #6b4950;
    }

    /* Input Customizado */
    .password-wrapper {
        position: relative;
        display: flex;
        align-items: center;
    }

    .password-input {
        font-size: 1.5rem;
        letter-spacing: 2px;
        color: #6b4950;
        background-color: #fafafa;
        border: 2px solid #eacbd2;
        border-radius: 12px;
        padding: 15px 50px 15px 20px; /* Espaço para o ícone na direita */
        width: 100%;
        text-align: center;
        transition: all 0.3s ease;
        font-family: 'Courier New', monospace; /* Fonte monoespaçada para senhas é mais pro */
    }

    .password-input:focus {
        outline: none;
        border-color: #6b4950;
        background-color: #fff;
        box-shadow: 0 0 0 4px rgba(234, 203, 210, 0.3);
    }

    /* Botão de Olho (Dentro do input) */
    .toggle-password-btn {
        position: absolute;
        right: 15px;
        background: none;
        border: none;
        cursor: pointer;
        color: #999;
        transition: color 0.3s;
        display: flex;
        align-items: center;
    }

    .toggle-password-btn:hover {
        color: #6b4950;
    }

    /* Botão de Copiar */
    .btn-copy {
        background-color: white;
        border: 2px solid #eacbd2;
        color: #6b4950;
        border-radius: 50px;
        padding: 10px 25px;
        font-weight: 600;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    .btn-copy:hover {
        background-color: #fff0f3;
        transform: translateY(-2px);
    }

    .btn-copy.copied {
        background-color: #28a745; /* Verde Sucesso */
        border-color: #28a745;
        color: white;
    }

    .btn-login-action {
        background-color: #6b4950;
        color: white;
        border-radius: 12px;
        padding: 12px;
        font-weight: bold;
        transition: background 0.3s;
    }
    
    .btn-login-action:hover {
        background-color: #5a3d43;
        color: white;
    }
</style>

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            
            <div class="reveal-card p-5 text-center">
                
                <div class="icon-header mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 9.9-1"></path>
                    </svg>
                </div>

                <h2 class="mb-2" style="color: #6b4950; font-weight: 700;">Senha Recuperada</h2>
                <p class="text-muted mb-4">Olá, {{ nome }}! Aqui está sua credencial de acesso.</p>

                <div class="mb-4">
                    <div class="password-wrapper">
                        <input type="password" 
                               value="{{ senha }}" 
                               id="campoSenha" 
                               class="password-input" 
                               readonly>
                        
                        <button type="button" class="toggle-password-btn" onclick="alternarVisibilidade()" title="Mostrar/Ocultar">
                            <svg id="iconeOlho" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg id="iconeOlhoFechado" style="display:none;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                </div>

                <button onclick="copiarSenha()" id="btnCopiar" class="btn-copy mb-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                    <span id="textoCopiar">Copiar Senha</span>
                </button>

                <div class="d-grid">
                    <a href="{{ url_for('login') }}" class="btn btn-login-action btn-lg">
                        Ir para o Login
                    </a>
                </div>

            </div>
        </div>
    </div>
</div>

<script>
    function alternarVisibilidade() {
        const input = document.getElementById("campoSenha");
        const olhoAberto = document.getElementById("iconeOlho");
        const olhoFechado = document.getElementById("iconeOlhoFechado");

        if (input.type === "password") {
            input.type = "text";
            olhoAberto.style.display = "none";
            olhoFechado.style.display = "block";
        } else {
            input.type = "password";
            olhoAberto.style.display = "block";
            olhoFechado.style.display = "none";
        }
    }

    function copiarSenha() {
        const input = document.getElementById("campoSenha");
        const btn = document.getElementById("btnCopiar");
        const texto = document.getElementById("textoCopiar");

        // Seleciona o texto (mobile friendly)
        const tipoOriginal = input.type;
        input.type = "text"; // Garante que copia o texto e não bolinhas
        input.select();
        input.setSelectionRange(0, 99999); 
        
        // Copia
        navigator.clipboard.writeText(input.value).then(() => {
            // Feedback Visual de Sucesso
            btn.classList.add("copied");
            texto.innerText = "Copiado!";
            
            // Retorna ao estado original após 2 segundos
            setTimeout(() => {
                btn.classList.remove("copied");
                texto.innerText = "Copiar Senha";
            }, 2000);
        });

        // Restaura o tipo do input se estava oculto
        if (tipoOriginal === "password") {
            input.type = "password";
        }
    }
</script>
{% endblock %}